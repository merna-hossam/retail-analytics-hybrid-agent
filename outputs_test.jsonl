{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "-- TODO: NL->SQL not implemented yet", "confidence": 0.95, "explanation": "Looked up the product policy line for unopened Beverages and extracted the return window in days.", "citations": ["product_policy::chunk0"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "", "quantity": 0}, "sql": "SELECT\n            c.CategoryName AS category,\n            SUM(od.Quantity) AS total_quantity\n        FROM \"Order Details\" AS od\n        JOIN Orders AS o ON od.OrderID = o.OrderID\n        JOIN Products AS p ON od.ProductID = p.ProductID\n        JOIN Categories AS c ON p.CategoryID = c.CategoryID\n        WHERE\n            o.OrderDate BETWEEN '1997-06-01' AND '1997-06-30'\n        GROUP BY c.CategoryName\n        ORDER BY total_quantity DESC\n        LIMIT 1;", "confidence": 0.5, "explanation": "No orders were found between 1997-06-01 and 1997-06-30, so there is no top-selling category; returning an empty result.", "citations": ["Orders", "Order Details", "Products", "Categories", "marketing_calendar::chunk0", "catalog::chunk0"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 0.0, "sql": "SELECT\n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))\n            / COUNT(DISTINCT o.OrderID) AS aov\n        FROM \"Order Details\" AS od\n        JOIN Orders AS o ON od.OrderID = o.OrderID\n        WHERE o.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';", "confidence": 0.9, "explanation": "Computed Average Order Value for Winter Classics 1997 using the KPI definition and orders between 1997-12-01 and 1997-12-31.", "citations": ["Orders", "Order Details", "kpi_definitions::chunk0", "marketing_calendar::chunk1"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.235}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.232}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT\n            p.ProductName AS product,\n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n        FROM \"Order Details\" AS od\n        JOIN Products AS p ON od.ProductID = p.ProductID\n        GROUP BY p.ProductName\n        ORDER BY revenue DESC\n        LIMIT 3;", "confidence": 0.9, "explanation": "Computed total revenue per product from Order Details joined with Products, then returned the top 3 by revenue.", "citations": ["Order Details", "Products"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 0.0, "sql": "SELECT\n            SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS revenue\n        FROM \"Order Details\" AS od\n        JOIN Orders AS o ON od.OrderID = o.OrderID\n        JOIN Products AS p ON od.ProductID = p.ProductID\n        JOIN Categories AS c ON p.CategoryID = c.CategoryID\n        WHERE\n            o.OrderDate BETWEEN '1997-06-01' AND '1997-06-30'\n            AND c.CategoryName = 'Beverages';", "confidence": 0.9, "explanation": "Computed total revenue from the Beverages category during Summer Beverages 1997 using the KPI revenue formula and orders between 1997-06-01 and 1997-06-30.", "citations": ["Orders", "Order Details", "Products", "Categories", "marketing_calendar::chunk0", "catalog::chunk0"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "", "margin": 0.0}, "sql": "SELECT\n            c.CompanyName AS customer,\n            SUM(0.3 * od.UnitPrice * od.Quantity * (1 - od.Discount)) AS margin\n        FROM \"Order Details\" AS od\n        JOIN Orders AS o ON od.OrderID = o.OrderID\n        JOIN Customers AS c ON o.CustomerID = c.CustomerID\n        WHERE\n            o.OrderDate BETWEEN '1997-01-01' AND '1997-12-31'\n        GROUP BY c.CompanyName\n        ORDER BY margin DESC\n        LIMIT 1;", "confidence": 0.5, "explanation": "No orders were found in 1997 when computing gross margin; returning an empty result as fallback.", "citations": ["Orders", "Order Details", "Customers", "kpi_definitions::chunk0"]}
